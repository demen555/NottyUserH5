<template>
  <div class="tag">
    <HeaderTop @refresh="onRefresh"></HeaderTop>
    <Nav :title="$t('str_footer_nav5')" text></Nav>
    <div class="police">
      <div class="police-title">{{ $t('str_footer_ncc1') }}</div>
      <div class="police-title-text">{{ $t('str_footer_ncc5') }}</div>
      <div class="police-text-content">
        {{ $t('str_footer_ncc3') }}
      </div>
      <div class="police-title">{{ $t('str_footer_ncc4') }}</div>
      <div class="police-text-content">{{ $t('str_footer_ncc5') }}</div>
      <div class="police-title">{{ $t('str_footer_ncc6') }}</div>
      <div class="police-text-content">{{ $t('str_footer_ncc7') }}</div>
      <div class="police-text-content-next">{{ $t('str_footer_ncc8') }}</div>
      <div class="police-text-content-next">{{ $t('str_footer_ncc9') }}</div>
      <div class="police-text-content-next">{{ $t('str_footer_ncc10') }}</div>
      <div class="police-text-content-next">{{ $t('str_footer_ncc11') }}</div>
      <div class="police-text-content-next">{{ $t('str_footer_ncc12') }}</div>
      <div class="police-title" style="margin: 10px 0;">{{ $t('str_footer_ncc13') }}</div>
      <div class="police-text-content-next">{{ $t('str_footer_ncc14') }}</div>
      <div class="police-text-content-next">{{ $t('str_footer_ncc15') }}</div>
      <div class="police-text-content-next">{{ $t('str_footer_ncc16') }}</div>
      <div class="police-text-content">{{ $t('str_footer_ncc17') }}</div>
      <div class="police-text-content">{{ $t('str_footer_ncc18') }}</div>
      <div class="police-text-content">{{ $t('str_footer_ncc19') }}</div>
      <div class="police-text-content-next">{{ $t('str_footer_ncc20') }}</div>
      <div class="police-text-content-next-next">{{ $t('str_footer_ncc21') }}</div>
      <div class="police-text-content-next-next">{{ $t('str_footer_ncc22') }}</div>
      <div class="police-text-content-next-next">{{ $t('str_footer_ncc23') }}</div>
      <div class="police-text-content-next">{{ $t('str_footer_ncc24') }}</div>
      <div class="police-text-content-next">{{ $t('str_footer_ncc25') }}</div>
      <div class="police-text-content-next">{{ $t('str_footer_ncc26') }}s</div>
      <div class="police-text-content">{{ $t('str_footer_ncc27') }}</div>
      <div class="police-title">{{ $t('str_footer_ncc28') }}</div>
      <div class="police-text-content">{{ $t('str_footer_ncc29') }}</div>
      <div class="police-title">{{ $t('str_footer_ncc30') }}</div>
      <div class="police-text-content">{{ $t('str_footer_ncc31') }}</div>
      <div class="police-title">{{ $t('str_footer_ncc32') }}</div>
      <div class="police-text-content">{{ $t('str_footer_ncc33') }}</div>
      <div class="police-title">{{ $t('str_footer_ncc34') }}</div>
      <div class="police-text-content">{{ $t('str_footer_ncc35') }}</div>
      <div class="police-title">{{ $t('str_footer_ncc36') }}</div>
      <div class="police-text-content">{{ $t('str_footer_ncc37') }}</div>
      <div class="police-text-content-next">{{ $t('str_footer_ncc38') }}</div>
      <div class="police-text-content-next">{{ $t('str_footer_ncc39') }}</div>
      <div class="police-text-content-next">{{ $t('str_footer_ncc40') }}</div>
      <div class="police-title">{{ $t('str_footer_ncc41') }}</div>
      <div class="police-text-content">{{ $t('str_footer_ncc42') }}
      </div>
      <div class="police-title">{{ $t('str_footer_ncc43') }}</div>
      <div class="police-text-content">{{ $t('str_footer_ncc44') }}
        <br>{{ $t('str_footer_ncc45') }}
        <br>{{ $t('str_footer_ncc46') }}
        <br>{{ $t('str_footer_ncc47') }}
      </div>
      <div class="police-title">{{ $t('str_footer_ncc48') }}</div>
      <div class="police-text-content">
        {{ $t('str_footer_ncc49') }}
        <br>https://www.esafety.gov.au/about-us
        <br>{{ $t('str_footer_ncc50') }}
      </div>
      <div class="police-title">{{ $t('str_footer_ncc51') }}</div>
      <div class="police-text-content">
        {{ $t('str_footer_ncc52') }}
        <br>{{ $t('str_footer_ncc53') }}
        <br>p://www.safernet.org.br/site/webline
      </div>
      <div class="police-title">{{ $t('str_footer_ncc54') }}</div>
      <div class="police-text-content">
        {{ $t('str_footer_ncc55') }}
        <br>https://igvm-iefh.belgium.be/fr/institut
        <br>1800 12 800
        <br>egalite.hommesfemmes@iefh.belgique.be
      </div>
      <div class="police-title">{{ $t('str_footer_ncc56') }}</div>
      <div class="police-text-content">
        {{ $t('str_footer_ncc57') }}
        <br>{{ $t('str_footer_ncc58') }}
        <br>ywcanada.ca/en > Guide on Sexual Image Based Abuse
      </div>
      <div class="police-title">{{ $t('str_footer_ncc59') }}</div>
      <div class="police-text-content">
        {{ $t('str_footer_ncc60') }}
        <br>https://stopchikane.nu/om-stopchikane/hvem-er-stopchikane/
        <br>28 83 40 70
        <br>kontakt@stopchikane.nu
      </div>
      <div class="police-title">{{ $t('str_footer_ncc61') }}</div>
      <div class="police-text-content">
        {{ $t('str_footer_ncc62') }}
        <br>{{ $t('str_footer_ncc63') }}
        <br>https://service-public.fr/particuliers/vosdroits/F32103
      </div>
      <div class="police-title">{{ $t('str_footer_ncc64') }}</div>
      <div class="police-text-content">
        {{ $t('str_footer_ncc65') }}
        <br>https://rainlily.org.hk/chi/about
        <br>safechat@rainlily.org.hk
      </div>
    </div>
  </div>
</template>
<script>
import { mapActions } from 'vuex'
import Nav from '@/components/nav'
import Thumb from '@/components/thumb'
import empty from '@/components/empty'
import tagLoad from "@/components/skeleton/tagLoad.vue"
import commonMinxin from '~/plugins/mixins/common'
import CODES from "~/plugins/enums/codes"


export default{
  name: 'police-ncc',
  mixins: [commonMinxin],
  data() {
    return {
      tagList: [],
      refreshing: false,
      spinnerLoading: false,
      loading: false,
      finished: false,
      pageInfo: {
        page: 1,
        size: 50,
        letter: ''
      },
      total: 0,
      tagIndex: 0,
      tags: [this.$t('str_menu_tag_all'), 'A', 'B', 'C', 'D', 'E', 'F', 'G', 'H', 'I', 'J', 'K', 'L', 'M', 'N', 'O', 'P', 'Q', 'R', 'S', 'T', 'U', 'V', 'W', 'X', 'Y', 'Z']
    }
  },
  components: {
    Nav,
    Thumb,
    empty,
    tagLoad
  },
  created(){
    this.initTagList('first')
  },
  methods: {
    ...mapActions(['set_tagid']),
    handleClickTag(item){
      gtag('event', 'gt4_click_tags', {
        id: item.id,
        name: item.name,
      });
      console.log(item)
      this.set_tagid(item.id)
      this.$router.push({
        name: 'type-id-name',
        params:{
          id: item.id,
          name: item.name,
          refresh: true,
        },
      });
    },
    handleClickTagName(item, index){
      this.tagIndex = index
      index != 0 ? (this.pageInfo.letter = item) : delete this.pageInfo.letter
      console.log(this.pageInfo.size, this.pageInfo.page, 'tagName')
      index !== 0 ? this.clickShow = true : this.clickShow = false // 为了防止切换tab时候，当一个有下拉加载时候不在第一页，然后切换tab时候，会同时触发刷新和下拉，当前是阻止只有在所有标签时候触发
      this.onRefresh()
    },
    onLoad(){
      if(this.clickShow) return this.loading = false
      console.log(this.pageInfo, 'onLoad')
      this.pageInfo.page += 1
      this.initTagList(); 
    },
    async initTagList(isRefresh = false){
      try {
        isRefresh === 'first'  && (this.spinnerLoading = true)
        !isRefresh  && (this.loading = true)
        const res = await this.$homeApi.postTagListPage(this.pageInfo)
        if(res.code === CODES.SUCCESS){
          this.total = res.data.meta.pagination.total
          if(isRefresh){
            this.tagList = res.data.data || []
            this.refreshing = false
          } else {
            this.tagList = [ ...this.tagList, ...res.data.data]
            this.loading = false
          }
          if(res.data.data.length === 0){
            this.finished = true
          } else {
            this.finished = false
          }
        }

      } catch (error) {

      } finally {
        this.spinnerLoading = false
        this.loading = false
        this.refreshing = false
      }
    },
    onRefresh() {
      this.pageInfo.page = 1
      this.initTagList(true)
    }
  }
}
</script>
<style lang="less" scoped>
.thumb{
  display: flex;
  flex-wrap: wrap;
  justify-content: space-between;
  margin: 0 12px;
}
.tag-box{
  margin: 10px 12px;
  height: 44px;
  border-radius: 4px;
  background-color: var(--bg-color3);
  border: 1px solid var(--bg-color3);
  display: flex;
  flex-wrap: wrap;
  padding: 4px 8px;
  font-size: 12px;
  line-height: 16.8px;
  .tag-name{
    margin: 0 2px;
    line-height: 16.8px;
    text-decoration: underline;
    text-underline-offset: 3px;
  }
  .tag-color{
    color: var(--bg-primary);
  }
  .tag-line{
    text-decoration: none;
  }
}
.tag-item{
  width: 172px;
  height: 32px;
  border-radius: 4px;
  background-color: var(--bg-color2);
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 8px;
  font-size: 12px;
  color: var(--text-color2);
  text-align: center;
}
</style>